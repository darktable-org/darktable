

We're proud to announce the new feature release of darktable, 4.2.0!

The github release is here: [https://github.com/darktable-org/darktable/releases/tag/release-4.2.0](https://github.com/darktable-org/darktable/releases/tag/release-4.2.0).

As always, please don't use the autogenerated tarball provided by
github, but only our tar.xz file. The checksums are:

```
$ sha256sum darktable-4.2.0.tar.xz
??? darktable-4.2.0.tar.xz
$ sha256sum darktable-4.2.0.dmg
??? darktable-4.2.0.dmg
$ sha256sum darktable-4.2.0.exe
??? darktable-4.2.0.exe
```

When updating from the stable 4.0.x series, please bear in
mind that your edits will be preserved during this process, but the new
library and configuration will no longer be usable with 4.0.x.

You are strongly advised to take a backup first.

#### Important note: to make sure that darktable can keep on supporting the raw file format for your camera, *please* read [this post](https://discuss.pixls.us/t/raw-samples-wanted/5420?u=lebedevri) on how/what raw samples you can contribute to ensure that we have the *full* raw sample set for your camera under CC0 license!

Since darktable 4.0:

- Almost ???? commits to darktable+rawspeed
- ??? pull requests handled
- ??? issues closed

## The Big Ones

The following is a summary of the main features added to darktable
4.2. These features are described more fully in the user manual and
accompanying blog post.

- New Sigmoid display transform module.

- Two new highlight recovery algorithms are proposed: in-paint opposed
  and segmentation. The in-paint opposed has proved to be very stable
  and good in a lot of pictures, so it has been made the default now.

- A full rework of the image display has been done. An initial work
  has been to create an easy-to-use image display on the central
  area. This routine supports both focus-peaking and
  color assessment. This routine is now used for the darkroom area,
  for the second window, and the duplicates.

  So, the second window gets the focus-peaking display and more
  importantly the color assessment mode which is an important feature.

  To achieve that properly, a new routine has been created which runs a
  separate pixelpipe which is fully equivalent to the darkroom
  one. This gives a properly aligned display.

  Using the new pixelpipe and display routines, the snapshot routine
  has been reworked. This new version has fully dynamic snapshots. The
  snapshot can be panned and zoomed and still perfectly aligned with
  the darkroom display which permits a proper comparison.

- Add style preview in lighttable style module and in darkroom style
  widget. The preview is displayed in the tooltip when hovering over the
  style entries. The tooltip UI has been redesigned at the same time.

- The lens module gains built-in support. Some cameras record
  lens correction values into the EXIF. Those data are now retrieved
  and used by the lens module to do the corresponding corrections.

- JPEG XL (read / write)

- Show modules with transition + keep them fully visible when opening
  or expanding.

- Large pixelpipe cache overhaul.

## Other Changes

- Add support for manipulating masks without scrolling (for tablet
  users). The mask manager has been enhanced with a new collapsible
  section containing controls for changing the masks' properties.

  It is also possible to change a property shared by a group of mask.

  At the same time, the circle and ellipse masks have been enhanced
  with new on-canvas controls to change the size and feather.

- Add WebP read support.

- Embedded ICC profile in exported WebP file.

- A double click on a notebook tab resets all widgets it contains.

- Support regional date/time format in thumbnail tooltips.

- Show lua command in action tooltip.

- Remove SSE code path from White Balance and Color Out modules. The
  optimized code from the compiler gives comparable speed.

- Add support for JFIF (JPEG File Interchange Format) file extension
  which is a standard JPEG.

- The preference to auto-apply a sharpening has been removed. One can
  add an auto-applied preset in the sharpen module and gain the same
  effect.

- Add support for updating existing pictures in Piwigo export.

- The White Balances presets have been migrated to an external JSON file.

- Remove Color Balance layout and White Balance control background
  color from preferences as this can be done directly on the modules
  themselves.

- Improve profile support for AVIF & EXR format.

- The current collection image count is now shown in the toolbox. This
  makes this information available even if the top hinter area is
  hidden.

- Try to get color space for PNG files from the cICP chunk. This was
  added in a recent revision of the PNG spec, so we take advantage of
  it if present.

- The reading of 16-bit half float for TIFF format is now done using
  the Imath library.

- Enable actions on the export format and storage widgets. This means
  that they can be mapped to shortcuts.

- Introduce balanced OpenCL vs CPU tiling. This makes it possible to
  use CPU tiling, if there is not enough memory on the OpenCL card and
  so would require a lot of tiles to be handled on the card. At the
  end, the large number of tiles plus the overlapping area will make
  the use of the OpenCL code patch slower (or much slower) than
  handling the image without tiling on CPU.

- In preview mode, the overlay display block is not shown by
  default. Moving the cursor on the half top of the thumb will display
  it. The block is still hidden automatically after some timeout.

- Set light patterns for Behringer b-control midi rotors
  (BCR2000/BCF2000)

- Fix reading of EXIF metadata when importing EXRs (if desired,
  existing files must be re-imported, refreshing metadata is not an
  option).

- Add support for scrolling through presets with shortcuts.

## Bug Fixes

- Properly use the display color profile in the slideshow. This was
  missing, and so images were just ignoring the color profile and were
  displayed (very) differently than on the lighttable or in the darkroom.

- Properly honor the modules' off status of in a style. Using a style
  in the export module can now be used to disable a module otherwise
  enabled in the history stack.

- Fix bauhaus popup size and position.

- Fix iop-order name on reset.

- Do not display deprecated module actions in the preferences' shortcuts section.

- Fix some bauhaus widgets popup positioning on Wayland.

- Fix speed issue when importing large folders with XMP having a lot of
  metadata.

- Fix some missing GUI updates in the Liquify module. In some cases,
  changing the strength of a node in a curve or line was not properly
  updating the displacement values.

- Fix bad interaction between the color assessment mode and the side
  panels.

- Fix infinity focus display in image information.

- Fix translation of retouch module toast messages.

- When importing, we keep the folder or filmroll property, if active. If
  another collection mode was selected, we use the default filmroll
  one.

- Fix Lab conversion in TIFF import.

- Fix highlights visualization in all recovery modes.

- Fix X-Trans highlight reconstruction visual indicator.

- Fix undo/redo after a style applied via a shortcut.

- Do not rebuild the whole tree when deleting or editing a
  presets. This gives better stability to the UI.

- Fix some refresh of the mask manager when changing images.

- Fix mask selection after a continuous mask creation.

- Fix name and tooltip in demosaic preferences to be correct for all
  sensor kind.

- Remove the automatic check for OpenCL headroom as it caused
  more problems than it solved.

- Fix non-blinking cursor in the processing module search dialog. This
  was making the module look like it was not active.

- Properly record the libraw black level.

- Fix state of some UI buttons in the retouch module when switching images.

- Fix selection of unaltered images.

- Widgets in collapsed sections are not disabled anymore, making them
  actionable via shortcut.

## Lua

N/A

## Notes


## Changed Dependencies

N/A

## RawSpeed changes


## Camera support, compared to 4.0

### Base Support


### White Balance Presets


### Noise Profiles


### Custom Color Matrices

### Suspended Support

No samples on raw.pixls.us

- Canon EOS M2
- Creo/Leaf Aptus 22(LF3779)/Hasselblad H1
- Fujifilm FinePix HS50EXR
- Fujifilm FinePix S6000fd
- Fujifilm FinePix S9600fd
- Fujifilm IS-1
- GoPro FUSION
- Kodak EasyShare Z980
- Leaf Aptus-II 5(LI300059)/Mamiya 645 AFD
- Leaf Credo 60
- Leaf Credo 80
- Leica D-LUX 6
- Minolta DiMAGE 5
- Nikon 1 J4
- Nikon 1 S1
- Nikon Coolpix P7700
- Nikon D1H
- Nikon D2H
- Nikon D3S
- Olympus E-10
- Olympus SP320
- Olympus SP570UZ
- Panasonic DMC-FX150
- Panasonic DMC-G2
- Pentax K200D
- Pentax K2000
- Pentax Q10
- Phase One IQ250
- Samsung GX10
- Samsung GX20
- Samsung NX5
- Samsung NX10
- Samsung NX11
- Samsung NX20
- Samsung NX2000
- Samsung EK-GN120
- Samsung SM-G920F
- Samsung SM-G935F
- Sinar Hy6/ Sinarback eXact
- Sony DSLR-A380
- Sony DSLR-A560
- ST Micro STV680

## Translations

- Albanian
- Turkish (New)

