cmake_minimum_required(VERSION 2.8.5)

include_directories(${CMAKE_CURRENT_SOURCE_DIR}/..)
include_directories(${CMAKE_CURRENT_BINARY_DIR}/..)
add_executable(darktable-generate-cache main.c)

set_target_properties(darktable-generate-cache PROPERTIES CMAKE_BUILD_WITH_INSTALL_RPATH TRUE)
set_target_properties(darktable-generate-cache PROPERTIES CMAKE_INSTALL_RPATH_USE_LINK_PATH FALSE)
set_target_properties(darktable-generate-cache PROPERTIES INSTALL_RPATH ${RPATH_DT}/../${CMAKE_INSTALL_LIBDIR}/darktable)
set_target_properties(darktable-generate-cache PROPERTIES LINKER_LANGUAGE C)
if(CMAKE_COMPILER_IS_GNUCC)
	if (GCC_VERSION VERSION_GREATER 4.3)
		if (CMAKE_SYSTEM_NAME MATCHES "^(DragonFly|FreeBSD|NetBSD|OpenBSD)$")
			message("-- Force link to libintl on *BSD with GCC 4.3+")
			target_link_libraries(darktable-generate-cache -lintl)
		endif()
	endif()
endif()
target_link_libraries(darktable-generate-cache lib_darktable)
install(TARGETS darktable-generate-cache DESTINATION ${CMAKE_INSTALL_BINDIR})
